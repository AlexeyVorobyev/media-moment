# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ 3

1. –í—ã–ø–æ–ª–Ω–∏–ª –ø–µ—Ä–≤—ã–µ —ç—Ç–∞–ø—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞
    - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã —Å–≤–µ—Ä—Ç–∫–∏ –∏ —Å—Ä–µ–¥–Ω–µ–µ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–µ
–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ;
    - –∑–∞–ø–æ–ª–Ω–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É —Å–≤–µ—Ä—Ç–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ì–∞—É—Å—Å–∞ —Å –º–∞—Ç.
–æ–∂–∏–¥–∞–Ω–∏–µ–º, —Ä–∞–≤–Ω—ã–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º —Ü–µ–Ω—Ç—Ä–∞ –º–∞—Ç—Ä–∏—Ü—ã;

![image](images/1.png)
![image](images/2.png)
![image](images/3.png)

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è —Å–≤—ë—Ä—Ç–∫–∏:
–Ø–¥—Ä–æ (–æ–±—ã—á–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ 3-7 –ø–∏–∫—Å–µ–ª–µ–π) —Å–∫–æ–ª—å–∑–∏—Ç –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é.
–ù–∞ –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∏–∫—Å–µ–ª–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —è–¥—Ä–∞.
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—É–º–º–∏—Ä—É—é—Ç—Å—è, –∏ –∏—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –ø–æ–∑–∏—Ü–∏—é –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
   –†–∞–∑–º—ã—Ç–∏–µ –∏ –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞: –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
   –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫—Ä–∞—ë–≤: –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω—Ç—É—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤.
   –£—Å–∏–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∑–∫–æ—Å—Ç–∏.
   –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç—É—Ä: –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
   –§—É–Ω–∫—Ü–∏–∏ —Å–≤—ë—Ä—Ç–æ—á–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (CNN): –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –≥–ª—É–±–∏–Ω—ã.

–°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã —Å–≤—ë—Ä—Ç–∫–∏:

```python
def conv_matrix(matrix_size: int, ms_deviation: float | int) -> np.ndarray:
    """
    –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã —Å–≤—ë—Ä—Ç–∫–∏
    :param matrix_size: –†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã
    :param ms_deviation: –°—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
    :return: –ú–∞—Ç—Ä–∏—Ü–∞ numpy
    """
    matrix = np.zeros((matrix_size, matrix_size))  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É –Ω—É–ª—è–º–∏
    a = b = matrix_size // 2  # –°—á–∏—Ç–∞–µ–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –¥–≤—É–º–µ—Ä–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã

    # –ó–∞–ø–æ–ª—è–µ–º –º–∞—Ç—Ä–∏—Ü—É —Å–≤—ë—Ä—Ç–∫–∏
    for y in range(matrix_size):
        for x in range(matrix_size):
            print(y, x)
            matrix[y, x] = gauss.gauss(x, y, ms_deviation, a, b)

    return matrix
```

–§—É–Ω–∫—Ü–∏—è –≥–∞—É—Å—Å–∞:

![image](images/4.png)

```python
def gauss(x: int, y: int, sigma: float | int, a: float | int, b: float | int) -> float:
    """
    –§—É–Ω–∫—Ü–∏—è –ì–∞—É—Å—Å–∞
    :param x: –ü–µ—Ä–≤—ã–π –∏–Ω–¥–µ–∫—Å –º–∞—Ç—Ä–∏—Ü—ã
    :param y: –í—Ç–æ—Ä–æ–π –∏–Ω–¥–µ–∫—Å –º–∞—Ç—Ä–∏—Ü—ã
    :param sigma: –°—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
    :param a: –ú–∞—Ç. –æ–∂–∏–¥–∞–Ω–∏–µ –¥–≤—É–º–µ—Ä–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã
    :param b: –ú–∞—Ç. –æ–∂–∏–¥–∞–Ω–∏–µ –¥–≤—É–º–µ—Ä–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã
    :return: –ó–Ω–∞—á–µ–Ω–∏–µ –≥–∞—É—Å—Å–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    """
    double_sigma_squared = 2 * sigma * sigma
    return np.exp(-((x - a) ** 2 + (y - b) ** 2) / double_sigma_squared) / (np.pi * double_sigma_squared)
```

2. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–ª –º–∞—Ç—Ä–∏—Ü—É

```python
def normalize_matrix(matrix: np.ndarray) -> np.ndarray:
    """
    –ù–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É, —á—Ç–æ–±—ã —Å—É–º–º–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±—ã–ª–∞ —Ä–∞–≤–Ω–∞ 1
    :param matrix: –ò—Å—Ö–æ–¥–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
    :return: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
    """
    return matrix / np.sum(matrix)
```

3. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª –∞–ª–≥–æ—Ä–∏—Ç–º –±–ª—é—Ä–∞ –≥–∞—É—Å—Å–∞ –Ω–∞ python

–û–ø–µ—Ä–∞—Ü–∏—è —Å–≤–µ—Ä—Ç–∫–∏ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –∏—Å—Ö–æ–¥–Ω–æ–π
–º–∞—Ç—Ä–∏—Ü—ã B —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ ùëõ √ó ùëõ –≤ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π
–º–∞—Ç—Ä–∏—Ü—ã ker —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ ùëõ √ó ùëõ, –Ω–∞–∑—ã–≤–∞–µ–º–æ–π —è–¥—Ä–æ–º —Å–≤–µ—Ä—Ç–∫–∏

```python
def conv_operation(
        item_x: int,
        item_y: int,
        image: np.ndarray,
        kernel: np.ndarray,
        kernel_size: int
) -> float:
    """
    –ü—Ä–æ–≤–æ–¥–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏—é —Å–≤—ë—Ä—Ç–∫–∏

    :param item_x: –ò–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞ –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
    :param item_y: –ò–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞ –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
    :param image: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    :param kernel: –Ø–¥—Ä–æ —Å–≤—ë—Ä—Ç–∫–∏
    :param kernel_size: –†–∞–∑–º–µ—Ä —è–¥—Ä–∞ —Å–≤—ë—Ä—Ç–∫–∏
    :return:
    """
    value = 0
    half_size = int(kernel_size // 2)
    for k in range(-half_size, half_size + 1):
        for l in range(-half_size, half_size + 1):
            value += image[item_y + k, item_x + l] + kernel[k + half_size, l + half_size]

    return value
```

–ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Ñ—É–Ω–∫—Ü–∏—è:

```python
def gauss_blur(
        image: np.ndarray,
        kernel_size: int,
        deviation: float
) -> np.ndarray:
    """
        –û—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –±–ª—é—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –º–∞—Ç—Ä–∏—Ü—ã —Å–≤—ë—Ä—Ç–∫–∏ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ –≥–∞—É—Å—Å—É.

        :param: image: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        :param: kernel_size: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —è–¥—Ä–∞, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ—á—ë—Ç–Ω—ã–º
        :param: deviation: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –¥–ª—è –≥–∞—É—Å—Å–∞

        :return: –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        """

    if kernel_size % 2 == 1:
        raise Exception('Kernel size must be odd.')

    kernel = nm.normalize_matrix(
        convm.conv_matrix(kernel_size, deviation)
    )

    blurred_image = image.copy()
    h, w = image.shape[:2]
    half_kernel_size = int(kernel_size // 2)

    for y in range(half_kernel_size, h - half_kernel_size):  # –ü—Ä–æ—Ö–æ–¥ –ø–æ –º–∞—Ç—Ä–∏—Ü–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ
        for x in range(half_kernel_size, w - half_kernel_size):  # –ü—Ä–æ—Ö–æ–¥ –ø–æ –º–∞—Ç—Ä–∏—Ü–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ
            # –û–ø–µ—Ä–∞—Ü–∏—è —Å–≤—ë—Ä—Ç–∫–∏
            blurred_val = conv_operation(x,y,blurred_image, kernel, kernel_size)

            blurred_image[y, x] = blurred_val

    return image
```