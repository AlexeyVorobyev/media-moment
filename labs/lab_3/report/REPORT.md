# Лабораторная работа № 3

1. Выполнил первые этапы алгоритма
    - установить размер матрицы свертки и среднее квадратичное
отклонение;
    - заполнить матрицу свертки значениями функции Гаусса с мат.
ожиданием, равным координатам центра матрицы;

![image](images/1.png)
![image](images/2.png)
![image](images/3.png)

Основная идея свёртки:
Ядро (обычно небольшого размера 3-7 пикселей) скользит по изображению.
На каждой позиции значения пикселей изображения умножаются на соответствующие значения ядра.
Результаты суммируются, и итоговая сумма записывается в соответствующую позицию выходного изображения.

Применение в обработке изображений:
   Размытие и подавление шума: для улучшения качества изображения.
   Обнаружение краёв: для выделения контуров объектов.
   Усиление контрастности и резкости.
   Обнаружение текстур: для анализа структуры изображения.
   Функции свёрточных нейронных сетей (CNN): используются для извлечения признаков на различных уровнях глубины.

Создание и заполнение матрицы свёртки:

```python
def conv_matrix(matrix_size: int, ms_deviation: float | int) -> np.ndarray:
    """
    Создание и заполнение матрицы свёртки
    :param matrix_size: Размер матрицы
    :param ms_deviation: Среднеквадратичное отклонение
    :return: Матрица numpy
    """
    matrix = np.zeros((matrix_size, matrix_size))  # Инициализируем матрицу нулями
    a = b = matrix_size // 2  # Считаем математическое ожидание двумерной случайной величины

    # Заполяем матрицу свёртки
    for y in range(matrix_size):
        for x in range(matrix_size):
            print(y, x)
            matrix[y, x] = gauss.gauss(x, y, ms_deviation, a, b)

    return matrix
```

Функция гаусса:

![image](images/4.png)

```python
def gauss(x: int, y: int, sigma: float | int, a: float | int, b: float | int) -> float:
    """
    Функция Гаусса
    :param x: Первый индекс матрицы
    :param y: Второй индекс матрицы
    :param sigma: Среднеквадратичное отклонение
    :param a: Мат. ожидание двумерной случайной величины
    :param b: Мат. ожидание двумерной случайной величины
    :return: Значение гауссовой функции
    """
    double_sigma_squared = 2 * sigma * sigma
    return np.exp(-((x - a) ** 2 + (y - b) ** 2) / double_sigma_squared) / (np.pi * double_sigma_squared)
```

